# Store results here
outdir: /tmp/out
compress_collection: true
modules:
  # Capture e.g. network traffic to pcap
  capture:
    # seconds
    network_timeout: 60
    # Capture network traffic
    enable_network: true
    # Capture volatile memory
    enable_memory: false
    memory:
      capture_method: lime
      lime:
        path: memory/lime-6.14.0-36-generic.ko
        # Format: lime/raw
        format: lime
  collect:
    # Collect command outputs for the given commands
    enable_commnds: true
    # Copy files and directories from the given paths
    enable_files_and_dirs: true
    # Collect checksums for the given paths
    enable_checksums: true
    # Find luks devices and collect luksDump
    enable_luks: true
    # Collect file permissions for the given paths
    enable_file_permissions: true
    # Command outputs
    commands:
      - ps auxwwwef
      - aa-status
      - systemctl list-units --type=service --all
      - systemctl list-timers --all
      - systemctl status                 # general system status
      - aa-status                        # AppArmor status (if installed)
      - service --status-all             # SysV service status (if available)
      # Auditd
      - auditctl -l
      - auditctl -s
      - aureport -i --summary -ts recent
      # Users and login history
      - who
      - w
      - last
      - lastb
      - id
      - groups
      - getent passwd
      - getent shadow                     # requires root
      - getent group
      - crontab -l                        # current user
      - sudo crontab -l -u root           # root crontab
      # Network and connections
      - netstat -tulnpa
      - ss -tulnpa
      - ip addr show
      - ip route show
      - iptables-save
      - ufw status verbose
      - sshd -T
      # Package / installed software
      - dpkg -l                           # Debian/Ubuntu
      - rpm -qa                           # RHEL/CentOS
      - apt-cache policy                   # Debian package policy
      - yum list installed                 # RHEL package list
      - flatpak list                       # if flatpak is used
      - snap list                          # if snap is used
      # Disk and filesystem
      - df -h
      - mount
      - lsblk -f
      - findmnt
      # Kernel and system info
      - uname -a
      - cat /proc/version
      - dmesg
      - lsmod
      - sysctl -a
      # Network routes / ARP / firewall
      - ip neigh
      - arp -n
      # Docker / containers
      - docker ps -a                       # containers
      - docker images                      # images
      - docker info
      - kubectl get pods --all-namespaces
    # Files and directories to collect
    files_and_dirs:
      - /proc/version
      - /proc/cmdline
      - /proc/modules
      - /lib/systemd/system
      - /var/spool/cron/crontabs
      - /etc/
      - /root/.ssh
      - /home/*/.ssh
      - /root/.bash_history
      - /root/.zsh_history
      - /home/*/.bash_history
      - /home/*/.zsh_history
      - /var/lib/dpkg/status
      - /var/lib/rpm
      - /var/www/
      - /var/log/
      # Docker/Kubernetes (if present)
      #- /var/lib/docker
      #- /var/lib/kubelet
      # Key binaries and scripts
      #- /usr/bin
      #- /usr/local/bin
      #- /bin
      #- /sbin
      #- /usr/sbin
      # Temp files (possible malware drops)
      #- /tmp
      #- /var/tmp
    checksums:
      # Directories are always recursive
      - /etc/
      - /usr/bin
      - /usr/local/bin
      - /bin
      - /sbin
      - /usr/sbin
      #- /lib64
      #- /lib
      #- /usr/lib64
      #- /usr/lib
      #- /var/lib
    file_permissions:
      - /etc/
